<UserControl x:Class="Wideor.App.Features.Player.PlayerView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:local="clr-namespace:Wideor.App.Features.Player"
             xmlns:vlc="clr-namespace:LibVLCSharp.WPF;assembly=LibVLCSharp.WPF"
             mc:Ignorable="d"
             d:DesignHeight="450" d:DesignWidth="800">
  <UserControl.DataContext>
        <Binding RelativeSource="{RelativeSource Self}" Path="ViewModel" />
  </UserControl.DataContext>
  <UserControl.Resources>
    <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter" />
    <local:InverseBooleanToVisibilityConverter x:Key="InverseBooleanToVisibilityConverter" />
    <local:BooleanToPlayPauseConverter x:Key="PlayPauseConverter" />
    <local:TimeSpanConverter x:Key="TimeSpanConverter" />
  </UserControl.Resources>
  <Grid Background="Black">
        <Grid.RowDefinitions>
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <!-- å‹•ç”»ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ã‚¨ãƒªã‚¢ -->
        <Border Grid.Row="0" 
                Background="#1A1A1A"
                BorderBrush="#333333"
                BorderThickness="1">
            <Grid>
                <!-- å‹•ç”»è¡¨ç¤ºã‚¨ãƒªã‚¢ï¼ˆLibVLCSharp.WPFã®VideoViewã‚’ä½¿ç”¨ï¼‰ -->
                <vlc:VideoView MediaPlayer="{Binding MediaPlayer}"
                              HorizontalAlignment="Stretch"
                              VerticalAlignment="Stretch" />

                <!-- ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ï¼ˆå‹•ç”»ãŒèª­ã¿è¾¼ã¾ã‚Œã¦ã„ãªã„å ´åˆã«è¡¨ç¤ºï¼‰ -->
                <TextBlock Text="å‹•ç”»ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼"
                          Foreground="#666666"
                          FontSize="16"
                          HorizontalAlignment="Center"
                          VerticalAlignment="Center"
                          Visibility="{Binding IsLoaded.Value, Converter={StaticResource InverseBooleanToVisibilityConverter}}" />

                <!-- ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º -->
                <Border Background="#CC000000"
                        Padding="16"
                        Visibility="{Binding HasError.Value, Converter={StaticResource BooleanToVisibilityConverter}}"
                        VerticalAlignment="Top"
                        HorizontalAlignment="Stretch">
                    <StackPanel>
                        <TextBlock Text="ã‚¨ãƒ©ãƒ¼"
                                  Foreground="#FF6B6B"
                                  FontWeight="Bold"
                                  FontSize="14" />
                        <TextBlock Text="{Binding ErrorMessage.Value}"
                                  Foreground="White"
                                  TextWrapping="Wrap"
                                  Margin="0,4,0,0" />
                    </StackPanel>
                </Border>
            </Grid>
        </Border>

        <!-- æ“ä½œãƒ‘ãƒãƒ« -->
        <Border Grid.Row="1"
                Background="#2A2A2A"
                BorderBrush="#333333"
                BorderThickness="0,1,0,0"
                Padding="12">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <!-- å†ç”Ÿ/ä¸€æ™‚åœæ­¢ãƒœã‚¿ãƒ³ -->
                <Button Grid.Column="0"
                       Command="{Binding TogglePlayPauseCommand}"
                       Width="40"
                       Height="40"
                       Margin="0,0,12,0"
                       Style="{StaticResource {x:Type Button}}">
                    <Button.Content>
                        <TextBlock Text="{Binding IsPlaying.Value, Converter={StaticResource PlayPauseConverter}}"
                                  FontSize="16"
                                  Foreground="White" />
                    </Button.Content>
                </Button>

                <!-- åœæ­¢ãƒœã‚¿ãƒ³ -->
                <Button Grid.Column="1"
                       Command="{Binding StopCommand}"
                       Width="40"
                       Height="40"
                       Margin="0,0,12,0"
                       HorizontalAlignment="Left">
                    <TextBlock Text="â– "
                              FontSize="12"
                              Foreground="White"
                              HorizontalAlignment="Center"
                              VerticalAlignment="Center" />
                </Button>

                <!-- æ™‚é–“è¡¨ç¤ºã¨ã‚·ãƒ¼ã‚¯ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ -->
                <Grid Grid.Column="2" VerticalAlignment="Center" Margin="12,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="*" MinWidth="200" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>

                    <!-- ç¾åœ¨æ™‚é–“ -->
                    <TextBlock Grid.Column="0"
                              Text="{Binding CurrentPosition.Value, Converter={StaticResource TimeSpanConverter}}"
                              Foreground="White"
                              FontSize="12"
                              Margin="0,0,8,0"
                              VerticalAlignment="Center"
                              MinWidth="60"
                              TextAlignment="Right" />

                    <!-- ã‚·ãƒ¼ã‚¯ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ -->
                    <Slider Grid.Column="1"
                           Minimum="0"
                           Maximum="{Binding TotalDuration.Value}"
                           Value="{Binding SeekPosition.Value, Mode=TwoWay}"
                           IsEnabled="{Binding IsLoaded.Value}"
                           VerticalAlignment="Center"
                           TickFrequency="1"
                           IsSnapToTickEnabled="False" />

                    <!-- ç·æ™‚é–“ -->
                    <TextBlock Grid.Column="2"
                              Text="{Binding TotalDuration.Value, Converter={StaticResource TimeSpanConverter}}"
                              Foreground="White"
                              FontSize="12"
                              Margin="8,0,0,0"
                              VerticalAlignment="Center"
                              MinWidth="60"
                              TextAlignment="Left" />
                </Grid>

                <!-- éŸ³é‡ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ« -->
                <Grid Grid.Column="3" VerticalAlignment="Center" Margin="12,0,0,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="80" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>

                    <TextBlock Grid.Column="0"
                              Text="ðŸ”Š"
                              FontSize="14"
                              Margin="0,0,8,0"
                              VerticalAlignment="Center" />

                    <Slider Grid.Column="1"
                           Minimum="0"
                           Maximum="1"
                           Value="{Binding Volume.Value, Mode=TwoWay}"
                           TickFrequency="0.1"
                           IsSnapToTickEnabled="False"
                           VerticalAlignment="Center" />

                    <TextBlock Grid.Column="2"
                              Text="{Binding Volume.Value, StringFormat='{}{0:P0}'}"
                              Foreground="White"
                              FontSize="11"
                              Margin="8,0,0,0"
                              VerticalAlignment="Center"
                              MinWidth="35" />
                </Grid>
            </Grid>
        </Border>
    </Grid>

</UserControl>
